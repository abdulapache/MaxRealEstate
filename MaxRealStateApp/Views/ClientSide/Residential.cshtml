@{
    ViewData["Title"] = "Residential";
    Layout = "~/Views/ClientSide/_ClientLayout.cshtml";
    var url = ViewBag.ApiBaseUrl;
}

@using MaxModels
@model MainModel
@using Newtonsoft.Json;

<div class="hero page-inner overlay" style="background-image: url('images/hero_bg_1.jpg')">
    <div class="container">
        <div class="row justify-content-center align-items-center">
            <div class="col-lg-9 text-center mt-5">
                <h1 class="heading" data-aos="fade-up">Residential</h1>
                <nav aria-label="breadcrumb" data-aos="fade-up" data-aos-delay="200">
                    <ol class="breadcrumb text-center justify-content-center">
                        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                        <li class="breadcrumb-item active text-white-50" aria-current="page">Residential</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</div>

<div class="container mt-3">
    <div class="row">
        <div class="col-md-6 mt-2">
            <p class="p-3 box-shadow"
               style="background-color: white; color:black; border: 1px solid rgb(184, 184, 184);">Residential</p>
        </div>
        <div class="col-md-6 mt-2">
            <select id="purpose" class="form-select p-3">
                <option>Purpose</option>
                <option>Sale</option>
                <option>Rent</option>
            </select>
        </div>
        <div class="col-md-3 mt-2">
            <select id="commercial-type" class="form-select p-3">
                <option value="0" selected>Commercial Type</option>
                <option value="Villa">Villa</option>
                <option value="Appartment">Appartment</option>
                <option value="Shop">Shop</option>
                <option value="Showroom">Showroom</option>
                <option value="Warehouse">Warehouse</option>
            </select>
        </div>
        <div class="col-md-3 mt-2">
            <select id="city" class="form-select p-3">
                <option value="0" selected>City</option>
                <option value="Dubai">Dubai</option>
                <option value="Abu Dhabi">Abu Dhabi</option>
            </select>
        </div>
    </div>
</div>

<div class="section">
    <div class="container">
        <div class="row">
            <div class="col-md-7" data-aos="fade-up">
                <h3>Residential</h3>
            </div>
            <div class="col-md-1 mt-3">
                <h6>Sort by:</h6>
            </div>
            <div class="col-md-3 d-block" data-aos="fade-up">
                <select id="city" class="form-select p-3">
                    <option>Date Listed: Newest</option>
                    <option>Date Listed: Oldest</option>
                    <option>Featured</option>
                    <option>Price:Lowest</option>
                    <option>Price:Highest</option>
                </select>
            </div>
            <div class="col-md-1 mt-2" data-aos="fade-up">
                <div class="col-auto d-flex">
                    <div id="gridbtn">
                        <i class="fas fa-th-large toggle-btn active"
                           style="cursor: pointer; font-size: 24px; padding: 5px; border-radius: 20%;"
                           onclick="gridProfile()"></i>
                    </div>
                    <div id="cardbtn" style="margin-left: 10px;">
                        <i class="fas fa-bars toggle-btn"
                           style="cursor: pointer; font-size: 24px; padding: 5px; border-radius: 20%;"
                           onclick="cardProfile()"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="section">
    <div class="container">
        <div class="row">
            @foreach (var item in Model.property)
            {
                <div class="col-md-3">
                    <div class="property-item"
                         data-purpose="@item.Purpose"
                         data-commercial-type="@item.CommercialType"
                         data-city="@item.City">
                        <a href="property-single.html" class="img">
                            <img src="@url/UploadedFiles/@item.Pic1" alt="Image" class="img-fluid" />
                        </a>
                        <div class="property-content">
                            <div class="price mb-2"><span>@item.Price</span></div>
                            <div>
                                <span class="d-block mb-2 text-black-50">@item.PropertyName</span>
                                <span class="city d-block mb-3">@item.City, @item.Country</span>
                                <div class="specs d-flex mb-4">
                                    <span class="d-block d-flex align-items-center me-3">
                                        <span class="icon-bed me-2"></span>
                                        <span class="caption">@item.TotalBedroom</span>
                                    </span>
                                    <span class="d-block d-flex align-items-center">
                                        <span class="icon-bath me-2"></span>
                                        <span class="caption">@item.TotalBath</span>
                                    </span>
                                </div>
                                <a href="property-single.html" class="btn btn-primary py-2 px-3">See details</a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Get filter dropdowns
        const purposeDropdown = document.getElementById("purpose");
        const commercialTypeDropdown = document.getElementById("commercial-type");
        const cityDropdown = document.getElementById("city");

        // Get all property items
        const propertyItems = document.querySelectorAll(".property-item");

        // Add event listeners for filter dropdowns
        purposeDropdown.addEventListener("change", filterProperties);
        commercialTypeDropdown.addEventListener("change", filterProperties);
        cityDropdown.addEventListener("change", filterProperties);

        function filterProperties() {
            // Get selected filter values
            const purpose = purposeDropdown.value.toLowerCase();
            const commercialType = commercialTypeDropdown.value.toLowerCase();
            const city = cityDropdown.value.toLowerCase();

            // Iterate over all property items
            propertyItems.forEach(item => {
                const itemPurpose = item.dataset.purpose.toLowerCase();
                const itemCommercialType = item.dataset.commercialType.toLowerCase();
                const itemCity = item.dataset.city.toLowerCase();

                const matchesPurpose = purpose === "purpose" || itemPurpose === purpose;
                const matchesCommercialType = commercialType === "0" || itemCommercialType === commercialType;
                const matchesCity = city === "0" || itemCity === city;

                if (matchesPurpose && matchesCommercialType && matchesCity) {
                    item.closest(".col-md-3").style.display = "block";
                } else {
                    item.closest(".col-md-3").style.display = "none";
                }
            });
        }

        // Initialize filtering on page load
        filterProperties();
    });
</script>
